<!DOCTYPE html><html translate="no"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5,user-scalable=yes"><meta name="google" content="notranslate"><title>PerTracker - Period Tracking App</title><link rel="manifest" href="./manifest.json"><meta name="theme-color" content="#B793DD"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="apple-mobile-web-app-title" content="PerTracker"><meta name="samsung-web-app-capable" content="yes"><meta name="samsung-web-app-status-bar-style" content="black-translucent"><link rel="apple-touch-icon" href="icons/icon-192.png"><link rel="icon" type="image/png" href="icons/icon-192.png"><link rel="shortcut icon" href="icons/icon-192.png"><link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"><style>:root{--p:#B793DD;--bg:#1C1B1F;--t:#FFF;--c:#2C2C2E;--e:rgba(255,255,255,.2);--l:rgba(255,255,255,.7)}*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui}body{background:var(--bg);color:var(--t);min-height:100vh}a,.b{cursor:pointer}.h{background:var(--p);display:flex;justify-content:space-between;align-items:center;padding:16px}.c{background:var(--c);border-radius:8px;padding:16px;margin:8px 0}.b{border:none;border-radius:20px;padding:8px 16px;font-size:14px;display:inline-flex;align-items:center;gap:8px}.bp{background:var(--p);color:var(--t)}.bs{background:rgba(0,0,0,.2);color:var(--t);border:1px solid var(--e)}.f{position:fixed;right:16px;bottom:16px;background:var(--p);color:var(--t);width:56px;height:56px;border-radius:50%;display:flex;justify-content:center;align-items:center;z-index:50}.fg{margin-bottom:16px}.l{display:block;margin-bottom:8px;font-size:14px;color:var(--l)}.t{width:100%;background:rgba(255,255,255,.08);border:1px solid var(--e);color:var(--t);padding:12px;border-radius:8px;font-size:16px;resize:vertical}.m{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;z-index:100}.md{background:var(--c);border-radius:8px;padding:16px;width:95%;max-width:500px;max-height:90vh;overflow:auto}.mh{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;border-bottom:1px solid rgba(255,255,255,.1);padding-bottom:8px}.mt{font-size:18px;font-weight:500;color:var(--t)}.mc{background:0 0;border:none;cursor:pointer;color:var(--l)}.mf{display:flex;justify-content:flex-end;gap:8px;margin-top:16px}.r{list-style:none}.ri{padding:12px;border-bottom:1px solid var(--e);display:flex;justify-content:space-between;align-items:center}.rd{font-weight:500}.rdt{color:var(--l);font-size:14px}.ra{display:flex;gap:8px}.sg{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:16px}.sc{background:rgba(255,255,255,.1);color:var(--t);padding:12px;border-radius:8px;text-align:center}.sv{font-size:20px;font-weight:500;margin:8px 0}.sl{font-size:12px;color:var(--l)}.e{text-align:center;padding:32px 0;color:var(--l)}.dp{position:relative;width:100%;margin-bottom:16px}.di{width:100%;padding:12px;padding-right:36px;background:rgba(255,255,255,.08);border:1px solid var(--e);border-radius:8px;color:var(--t);font-size:16px;cursor:pointer}.ci{position:absolute;right:12px;top:50%;transform:translateY(-50%);color:var(--l);pointer-events:none}.dd{position:absolute;top:calc(100% + 4px);left:0;width:300px;background:var(--c);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.3);z-index:100;overflow:hidden;display:flex;flex-direction:column}@media (max-width:600px){.dd{width:280px;left:50%;transform:translateX(-50%)}}.dh{display:flex;justify-content:space-between;align-items:center;padding:8px;border-bottom:1px solid rgba(255,255,255,.1)}.mn{display:flex;align-items:center;justify-content:space-between;width:100%}.mb{background:0 0;border:none;color:var(--t);cursor:pointer;width:30px;height:30px;display:flex;align-items:center;justify-content:center;border-radius:50%}.cm{font-weight:500;color:var(--t);font-size:14px}.cg{display:grid;grid-template-columns:repeat(7,1fr);padding:8px}.w{text-align:center;padding:4px 0;font-size:12px;color:var(--l);font-weight:500}.d{text-align:center;cursor:pointer;width:32px;height:32px;display:flex;align-items:center;justify-content:center;margin:2px auto;border-radius:50%;font-size:14px;color:var(--t)}.d:hover{background:rgba(255,255,255,.1)}.d.c{border:1px solid var(--e)}.d.s{background:var(--p);color:var(--t)}.d.o{color:rgba(255,255,255,.3)}.df{display:flex;justify-content:flex-end;padding:8px;border-top:1px solid rgba(255,255,255,.1)}.cs{position:relative;width:100%;margin-bottom:16px}.ch{background:rgba(255,255,255,.08);border:1px solid var(--e);border-radius:8px;padding:12px;color:var(--t);font-size:16px;cursor:pointer;display:flex;justify-content:space-between;align-items:center}.cd{position:absolute;top:calc(100% + 4px);left:0;width:100%;background:var(--c);border-radius:8px;box-shadow:0 4px 16px rgba(0,0,0,.3);z-index:100;overflow:hidden}.co{padding:12px;cursor:pointer;transition:background-color .2s;display:flex;align-items:center;gap:12px}.co:hover{background:rgba(255,255,255,.1)}.co.s{background:rgba(183,147,221,.2)}.fi{width:16px;height:16px;border-radius:50%;display:inline-block}.fl{background:#ffa0a0;opacity:.6}.fm{background:#ff5252;opacity:.8}.fh{background:#b71c1c}input[type=checkbox]{appearance:none;-webkit-appearance:none;width:20px;height:20px;min-width:20px;min-height:20px;border-radius:4px;border:2px solid var(--p);background-color:transparent;display:inline-flex;margin-right:12px;position:relative;vertical-align:middle}input[type=checkbox]:checked{background-color:var(--p)}input[type=checkbox]:checked::after{content:"";display:block;width:6px;height:10px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg);position:absolute;top:2px;left:5px}.cb{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;margin-top:12px}.cl{display:inline-flex;align-items:center;margin:0;color:var(--t)}.install-screen{display:flex;justify-content:center;align-items:center;min-height:100vh;padding:16px}.install-card{background:var(--c);border-radius:16px;padding:32px;text-align:center;max-width:400px;box-shadow:0 8px 32px rgba(0,0,0,.3)}.install-card h1{margin:16px 0;font-size:24px}.install-card p{margin:16px 0;color:var(--l);line-height:1.5}.install-btn{margin:24px 0 16px;font-size:16px;padding:12px 24px}.install-help{font-size:14px;color:var(--l)}</style></head><body><div id="app"><div v-if="!isPWA" class="install-screen"><div class="install-card"><i class="material-icons" style="font-size:64px;color:var(--p);margin-bottom:16px">install_mobile</i><h1>Install PerTracker</h1><p>This app must be installed to use. Click the button below to install it as a PWA.</p><button class="b bp install-btn" @click="installApp" v-if="canInstall"><i class="material-icons">download</i> Install App</button><p v-else class="install-help">Use the browser's install option or add to home screen</p></div></div><div v-else><div class="h"><h1>PerTrack</h1><button class="b bs" @click="showImportExportModal=true"><i class="material-icons">save_alt</i> Import/Export</button></div><div style="max-width:960px;margin:0 auto;padding:8px"><div class="c" v-if="records.length>1"><h2>Statistics</h2><div class="sg"><div class="sc"><i class="material-icons">calendar_month</i><div class="sv">{{stats.avgCycle}}d</div><div class="sl">Avg Cycle</div></div><div class="sc"><i class="material-icons">water_drop</i><div class="sv">{{stats.avgPeriod}}d</div><div class="sl">Avg Period</div></div><div class="sc"><i class="material-icons">event</i><div class="sv">{{formatDate(stats.nextPeriod)}}</div><div class="sl">Next</div></div></div></div><div class="c"><div style="display:flex;justify-content:space-between;margin-bottom:16px"><h2>Period Records</h2></div><div v-if="records.length===0" class="e"><i class="material-icons" style="font-size:36px;color:#777;margin-bottom:16px">event_busy</i><p>No period records yet</p><p>Add your first period record to start tracking</p><button class="b bp" @click="showAddModal=true" style="margin-top:16px"><i class="material-icons">add</i> Add First Record</button></div><ul v-else class="r"><li v-for="(record,index) in sortedRecords" :key="index" class="ri"><div><div class="rd">{{formatDate(record.startDate)}} <i class="material-icons" style="font-size:16px;color:#ff5252;vertical-align:sub">water_drop</i> <span v-if="record.endDate">to {{formatDate(record.endDate)}}</span><span v-else>to Present</span></div><div class="rdt"><span v-if="record.endDate">{{getDuration(record.startDate,record.endDate)}}d</span><span v-else>Active</span><span v-if="record.flow" style="margin-left:8px">· <span class="fi" :class="'f'+record.flow[0].toLowerCase()" style="display:inline-block;margin-right:4px;vertical-align:middle"></span>{{record.flow}}</span><span v-if="record.symptoms&&record.symptoms.length" style="margin-left:8px">· {{record.symptoms.join(', ')}}</span></div></div><div class="ra"><button class="b bs" style="padding:6px" @click="editRecord(index)"><i class="material-icons">edit</i></button> <button class="b bs" style="padding:6px" @click="deleteRecord(index)"><i class="material-icons">delete</i></button></div></li></ul></div><button class="f" @click="showAddModal=true"><i class="material-icons">add</i></button><div class="m" v-if="showAddModal"><div class="md"><div class="mh"><h3 class="mt">{{isEditing?'Edit':'Add'}} Period Record</h3><button class="mc" @click="showAddModal=false"><i class="material-icons">close</i></button></div><div class="fg"><label>Start Date</label><div class="dp"><div class="di" @click="openDatePicker('start')">{{formatDate(currentRecord.startDate)}}</div><i class="material-icons ci">calendar_today</i><div class="dd" v-if="datePickerState.showing&&datePickerState.field==='start'"><div class="dh"><div class="mn"><button class="mb" @click="changeMonth(-1)"><i class="material-icons">chevron_left</i></button><div class="cm">{{currentMonthName}} {{currentYear}}</div><button class="mb" @click="changeMonth(1)"><i class="material-icons">chevron_right</i></button></div></div><div class="cg"><div class="w" v-for="day in weekdays">{{day}}</div><div v-for="day in calendarDays" :class="['d',{'s':isSelectedDay(day.date),'c':isCurrentDay(day.date),'o':!day.inCurrentMonth}]" @click="selectDate(day.date)">{{day.dayNumber}}</div></div><div class="df"><button class="b bs" @click="closeDatePicker">Close</button></div></div></div></div><div class="fg"><label>End Date (leave empty if ongoing)</label><div class="dp"><div class="di" @click="openDatePicker('end')">{{currentRecord.endDate?formatDate(currentRecord.endDate):'Not set'}}</div><i class="material-icons ci">calendar_today</i><div class="dd" v-if="datePickerState.showing&&datePickerState.field==='end'"><div class="dh"><div class="mn"><button class="mb" @click="changeMonth(-1)"><i class="material-icons">chevron_left</i></button><div class="cm">{{currentMonthName}} {{currentYear}}</div><button class="mb" @click="changeMonth(1)"><i class="material-icons">chevron_right</i></button></div></div><div class="cg"><div class="w" v-for="day in weekdays">{{day}}</div><div v-for="day in calendarDays" :class="['d',{'s':isSelectedDay(day.date),'c':isCurrentDay(day.date),'o':!day.inCurrentMonth}]" @click="selectDate(day.date)">{{day.dayNumber}}</div></div><div class="df"><button class="b bs" @click="clearEndDate" style="margin-right:8px">Clear</button> <button class="b bs" @click="closeDatePicker">Close</button></div></div></div></div><div class="fg"><label>Flow Intensity</label><div class="cs"><div class="ch" @click="toggleFlowSelector"><div style="display:flex;align-items:center;gap:12px"><span class="fi" :class="'f'+currentRecord.flow[0].toLowerCase()"></span> {{currentRecord.flow}}</div><i class="material-icons">{{showFlowSelector?'keyboard_arrow_up':'keyboard_arrow_down'}}</i></div><div class="cd" v-if="showFlowSelector"><div v-for="flow in flowOptions" :key="flow" class="co" :class="{'s':currentRecord.flow===flow}" @click="selectFlow(flow)"><span class="fi" :class="'f'+flow[0].toLowerCase()"></span> {{flow}}</div></div></div></div><div class="fg"><label>Symptoms</label><div class="cb"><label v-for="symptom in availableSymptoms" :key="symptom" class="cl"><input type="checkbox" :value="symptom" v-model="currentRecord.symptoms">{{symptom}}</label></div></div><div class="fg"><label>Notes</label><textarea class="t" v-model="currentRecord.notes" rows="3"></textarea></div><div class="mf"><button class="b bs" @click="showAddModal=false">Cancel</button> <button class="b bp" @click="saveRecord">Save</button></div></div></div><div class="m" v-if="showImportExportModal"><div class="md"><div class="mh"><h3 class="mt">Import/Export Data</h3><button class="mc" @click="showImportExportModal=false"><i class="material-icons">close</i></button></div><div class="fg"><label>Export Data</label><p style="margin-bottom:12px;font-size:14px;color:var(--l)">Export your period tracking data as a .pertrack file for backup.</p><button class="b bp" @click="exportData"><i class="material-icons">file_download</i> Export to .pertrack</button></div><div class="fg"><label>Import Data</label><p style="margin-bottom:12px;font-size:14px;color:var(--l)">Import your period tracking data from a .pertrack file.</p><input type="file" id="importFile" accept=".pertrack" style="display:none" @change="handleFileSelect"><button class="b bs" @click="triggerFileInput"><i class="material-icons">file_upload</i> Select .pertrack File</button></div><div class="mf"><button class="b bs" @click="showImportExportModal=false">Close</button></div></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.45/vue.global.prod.min.js"></script><script src="twa-debug.js"></script><script>const{createApp,ref,computed,onMounted,watch}=Vue;createApp({setup(){const e=ref([]),t=ref(!1),a=ref(!1),n=ref(!1),r=ref(!1),s=ref(-1),isPWA=ref(!1),canInstall=ref(!1),deferredPrompt=ref(null),o=ref({startDate:(new Date).toISOString().split("T")[0],endDate:"",flow:"Medium",symptoms:[],notes:""}),d=["Light","Medium","Heavy"],i=ref({showing:!1,field:null,currentMonth:(new Date).getMonth(),currentYear:(new Date).getFullYear()}),l=["S","M","T","W","T","F","S"],c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],u=ref({avgCycle:0,avgPeriod:0,nextPeriod:null}),f=["Cramps","Headache","Bloating","Fatigue","Mood Swings","Acne","Back Pain","Breast Tenderness"];function g(){n.value=!n.value}function p(){n.value=!1}function m(e){o.value.flow=e,p()}const v=computed(()=>c[i.value.currentMonth]),h=computed(()=>i.value.currentYear),w=computed(()=>{const e=i.value.currentMonth,t=i.value.currentYear,a=new Date(t,e,1).getDay(),n=new Date(t,e+1,0).getDate(),r=new Date(t,e,0).getDate(),s=[];for(let n=a-1;n>=0;n--){const a=r-n,o=new Date(t,e-1,a);s.push({dayNumber:a,date:o.toISOString().split("T")[0],inCurrentMonth:!1})}for(let a=1;a<=n;a++){const n=new Date(t,e,a);s.push({dayNumber:a,date:n.toISOString().split("T")[0],inCurrentMonth:!0})}const o=42-s.length;for(let a=1;a<=o;a++){const n=new Date(t,e+1,a);s.push({dayNumber:a,date:n.toISOString().split("T")[0],inCurrentMonth:!1})}return s}),D=computed(()=>[...e.value].sort((e,t)=>new Date(t.startDate)-new Date(e.startDate)));function y(t){r.value=!0,s.value=t,o.value=JSON.parse(JSON.stringify(e.value[t])),a.value=!0}function S(t){confirm("Are you sure you want to delete this record?")&&e.value.splice(t,1)}function k(){if(!o.value.startDate)return void alert("Start date is required");if(o.value.endDate&&new Date(o.value.endDate)<new Date(o.value.startDate))return void alert("End date cannot be before start date");r.value?e.value[s.value]=JSON.parse(JSON.stringify(o.value)):e.value.push(JSON.parse(JSON.stringify(o.value))),a.value=!1,M()}function M(){o.value={startDate:(new Date).toISOString().split("T")[0],endDate:"",flow:"Medium",symptoms:[],notes:""},r.value=!1,s.value=-1}function C(e){if(!e)return"N/A";return new Date(e).toLocaleDateString()}function T(e,t){if(!e||!t)return 0;const a=new Date(e),n=new Date(t);return Math.ceil(Math.abs(n-a)/(1e3*60*60*24))}function I(e){if("end"===e&&!o.value.startDate)return void alert("Please select a start date first");const t="start"===e?o.value.startDate:o.value.endDate;if(t){const a=new Date(t);i.value.currentMonth=a.getMonth(),i.value.currentYear=a.getFullYear()}else if("end"===e&&o.value.startDate){const t=new Date(o.value.startDate);i.value.currentMonth=t.getMonth(),i.value.currentYear=t.getFullYear()}else i.value.currentMonth=(new Date).getMonth(),i.value.currentYear=(new Date).getFullYear();i.value.showing=!0,i.value.field=e}function x(){i.value.showing=!1,i.value.field=null}function b(e){let t=i.value.currentMonth+e,a=i.value.currentYear;t<0?(t=11,a--):t>11&&(t=0,a++),i.value.currentMonth=t,i.value.currentYear=a}function E(e){if("start"===i.value.field)o.value.startDate=e,o.value.endDate&&new Date(o.value.endDate)<new Date(e)&&(o.value.endDate="");else if("end"===i.value.field){if(new Date(e)<new Date(o.value.startDate))return void alert("End date cannot be before start date");o.value.endDate=e}x()}function P(){o.value.endDate="",x()}function N(e){return"start"===i.value.field?e===o.value.startDate:"end"===i.value.field&&e===o.value.endDate}function $(e){return e===(new Date).toISOString().split("T")[0]}function A(){if(e.value.length<2)return;const t=[...e.value].sort((e,t)=>new Date(e.startDate)-new Date(t.startDate));let a=0,n=0;for(let e=1;e<t.length;e++){const r=new Date(t[e].startDate),s=new Date(t[e-1].startDate),o=Math.round((r-s)/(1e3*60*60*24));o>0&&o<100&&(a+=o,n++)}let r=0,s=0;for(const e of t)if(e.endDate){const t=T(e.startDate,e.endDate);t>0&&t<15&&(r+=t,s++)}let o=null;if(n>0){const e=Math.round(a/n),r=new Date(t[t.length-1].startDate);(o=new Date(r)).setDate(o.getDate()+e)}u.value={avgCycle:n>0?Math.round(a/n):0,avgPeriod:s>0?Math.round(r/s):0,nextPeriod:o}}function O(){const t={records:e.value,appVersion:"1.0.0",exportDate:(new Date).toISOString()},a=JSON.stringify(t),n=new Blob([a],{type:"application/json"}),r=document.createElement("a");r.href=URL.createObjectURL(n),r.download=`pertrack-export-${(new Date).toISOString().slice(0,10)}.pertrack`,document.body.appendChild(r),r.click(),document.body.removeChild(r)}function B(){document.getElementById("importFile").click()}function F(t){const a=t.target.files[0];if(!a)return;if(!a.name.endsWith(".pertrack"))return void alert("Please select a .pertrack file");const n=new FileReader;n.onload=t=>{try{const n=JSON.parse(t.target.result);n&&Array.isArray(n.records)?confirm(`Import ${n.records.length} period records? This will replace your current data.`)&&(e.value=n.records,a.value=!1,alert("Data imported successfully!")):alert("Invalid file format. Could not import data.")}catch(e){alert("Error parsing file. Please make sure it is a valid .pertrack file."),console.error("Import error:",e)}},n.readAsText(a)}function L(e){if(i.value.showing){const t=document.querySelectorAll(".dd"),a=document.querySelectorAll(".di");let n=!1;t.forEach(t=>{t&&t.contains(e.target)&&(n=!0)});let r=!1;a.forEach(t=>{t===e.target&&(r=!0)}),n||r||x()}if(n.value){const t=document.querySelectorAll(".cs");let a=!1;t.forEach(t=>{t&&t.contains(e.target)&&(a=!0)}),a||p()}}function checkPWA(){isPWA.value=window.location.search.includes('installed=true')||window.navigator.standalone||window.matchMedia('(display-mode: standalone)').matches||window.matchMedia('(display-mode: minimal-ui)').matches}function installApp(){const isSamsung=/SamsungBrowser/.test(navigator.userAgent);if(isSamsung){alert('To install: Tap the menu (⋯) → Add to Home screen');return}if(deferredPrompt.value){deferredPrompt.value.prompt();deferredPrompt.value.userChoice.then(()=>{deferredPrompt.value=null;canInstall.value=false})}}onMounted(()=>{checkPWA();const t=localStorage.getItem("peridoTrackerData");t&&(e.value=JSON.parse(t),A()),document.addEventListener("click",L);window.addEventListener('beforeinstallprompt',e=>{e.preventDefault();deferredPrompt.value=e;canInstall.value=true});window.addEventListener('appinstalled',()=>{isPWA.value=true;canInstall.value=false})});watch(e,()=>{localStorage.setItem("peridoTrackerData",JSON.stringify(e.value)),A()},{deep:!0});return{records:e,sortedRecords:D,showAddModal:a,showImportExportModal:t,showFlowSelector:n,currentRecord:o,stats:u,isEditing:r,availableSymptoms:f,flowOptions:d,datePickerState:i,weekdays:l,currentMonthName:v,currentYear:h,calendarDays:w,editRecord:y,deleteRecord:S,saveRecord:k,formatDate:C,getDuration:T,exportData:O,triggerFileInput:B,handleFileSelect:F,openDatePicker:I,closeDatePicker:x,changeMonth:b,selectDate:E,clearEndDate:P,isSelectedDay:N,isCurrentDay:$,toggleFlowSelector:g,closeFlowSelector:p,selectFlow:m,isPWA,canInstall,installApp}}}).mount("#app");if('serviceWorker' in navigator){navigator.serviceWorker.register('./sw.js').then(()=>console.log('SW registered')).catch(e=>console.error('SW registration failed',e));}</script></body></html>
